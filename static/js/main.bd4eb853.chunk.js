(this["webpackJsonplibe-apps-template"]=this["webpackJsonplibe-apps-template"]||[]).push([[0],{130:function(e,t){},142:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(3),c=n(5),s=n(4),i=n(7),o=n(6),l=n(0),m=n.n(l),d=n(61),u=n.n(d),h=n(62);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var p=n(63),g=n(24),f=n.n(g),b=n(40),w=n(17),y=n(18),_=n(22),v=n(23),L=n(19),E=n(8),B=n(73),O=n(72),S=n.n(O);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(c.a)(this,Object(s.a)(t).call(this))).c="lblb-some-app",e.state={loading_sheet:!0,error_sheet:null,data_sheet:[],selectedSentences:[]},e.fetchSheet=e.fetchSheet.bind(Object(i.a)(e)),e.fetchCredentials=e.fetchCredentials.bind(Object(i.a)(e)),e.wiggle=e.wiggle.bind(Object(i.a)(e)),e.handleGeneration=e.handleGeneration.bind(Object(i.a)(e)),e.getParagraph=e.getParagraph.bind(Object(i.a)(e)),e.getRandomSentence=e.getRandomSentence.bind(Object(i.a)(e)),e.renderSentence=e.renderSentence.bind(Object(i.a)(e)),e.getParams=e.getParams.bind(Object(i.a)(e)),e.generateShareLink=e.generateShareLink.bind(Object(i.a)(e)),e}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){return this.fetchCredentials(),this.props.spreadsheet?this.fetchSheet():this.setState({loading_sheet:!1})}},{key:"fetchCredentials",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n,a,r,c,s,i,o,l,m;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.api_url,n=this.props.tracking,a=n.format,r=n.article,c="".concat(t,"/").concat(a,"/").concat(r,"/load"),e.prev=3,e.next=6,window.fetch(c,{method:"POST"});case 6:return s=e.sent,e.next=9,s.json();case 9:return i=e.sent,o=i._credentials,l=o.lblb_tracking,m=o.lblb_posting,window.LBLB_GLOBAL||(window.LBLB_GLOBAL={}),window.LBLB_GLOBAL.lblb_tracking=l,window.LBLB_GLOBAL.lblb_posting=m,e.abrupt("return",{lblb_tracking:l,lblb_posting:m});case 17:return e.prev=17,e.t0=e.catch(3),console.error("Unable to fetch credentials:"),console.error(e.t0),e.abrupt("return",Error(e.t0));case 22:case"end":return e.stop()}}),e,this,[[3,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchSheet",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n,a,r,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading_sheet:!0,error_sheet:null}),t=this.props.spreadsheet,e.prev=2,e.next=5,window.fetch(this.props.spreadsheet);case 5:if((n=e.sent).ok){e.next=8;break}throw n;case 8:return e.next=10,n.text();case 10:return a=e.sent,r=S()(a,[5]),c=r[0].filter((function(e){return""!==e.themes&&""!==e.sentence})),this.setState({error_sheet:null,data_sheet:c,sentences:c.map((function(e,t){return x({id:t},e)})),selectedSentences:this.getParams(),loading_sheet:!1}),e.abrupt("return",a);case 17:if(e.prev=17,e.t0=e.catch(2),!e.t0.status){e.next=26;break}return s="".concat(e.t0.status," error while fetching : ").concat(t),this.setState({loading_sheet:!1,error_sheet:e.t0}),console.error(s,e.t0),e.abrupt("return",Error(s));case 26:return this.setState({loading_sheet:!1,error_sheet:e.t0}),console.error(e.t0),e.abrupt("return",Error(e.t0));case 29:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"wiggle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};return r(),t<=n?setTimeout((function(s){return e.wiggle(t+1,n,a,r,c)}),a):c()}},{key:"handleGeneration",value:function(){var e=this,t=document.querySelectorAll(".speech .lblb-paragraph");this.wiggle(0,20,20,(function(){t.forEach((function(e){e.style.marginLeft="".concat(Math.random(),"rem"),e.style.transform="translateY(".concat(Math.random()-.5,"rem)"),e.style.filter="blur(2px)"}))}),(function(){t.forEach((function(e){e.style.marginLeft=0,e.style.transform="",e.style.filter=""})),e.setState({selectedSentences:[]}),e.forceUpdate()}))}},{key:"getRandomSentence",value:function(e,t){var n;switch(e){case"short":n=100;break;case"medium":n=250;break;default:n=500}for(var a=this.state.sentences.filter((function(e){var a=!0,r=!1,c=void 0;try{for(var s,i=t[Symbol.iterator]();!(a=(s=i.next()).done);a=!0){var o=s.value;if(e.themes.includes(o)&&e.sentence.length<n)return!0}}catch(l){r=!0,c=l}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return!1})),r=Math.floor(Math.random()*a.length);this.state.selectedSentences.includes(a[r].id);)r=Math.floor(Math.random()*a.length);return this.state.selectedSentences.push(a[r].id),a[r]}},{key:"getParagraph",value:function(e,t){for(var n=[],a=0;a<e;a++){var r=Math.random()>.8?Math.random()>.5?"short":"medium":"long",c=this.getRandomSentence(r,t);console.log(c.sentence,c.themes),t=Math.random()<.8?c.themes:["bullshit"],n.push(c)}return n}},{key:"renderSentence",value:function(e){return m.a.createElement("span",{className:"sentence",key:e.sentence},m.a.createElement("span",null,e.sentence+" "),m.a.createElement("span",{className:"sentence__tooltip",key:"".concat(e.sentence," tooltip")},m.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},m.a.createElement(B.a,{content:"".concat(e.president," ").concat(e.date.substring(0,4)).replace(/ /g,"&nbsp;")}))))}},{key:"getParams",value:function(){var e=new window.URL(window.location.href).searchParams.get("res");return e?window.atob(window.decodeURI(e)).split(";").map((function(e){return parseInt(e,36)})):[]}},{key:"generateShareLink",value:function(){var e=this.state.selectedSentences.map((function(e){return e.toString(36)})).join(";");return console.log("".concat(this.props.meta.url,"?res=").concat(window.encodeURI(window.btoa(e)))),"".concat(this.props.meta.url,"?res=").concat(window.encodeURI(window.btoa(e)))}},{key:"render",value:function(){var e=this.c,t=this.state,n=this.props,a=[e];return t.loading_sheet&&a.push("".concat(e,"_loading")),t.error_sheet&&a.push("".concat(e,"_error")),t.loading_sheet?m.a.createElement("div",{className:a.join(" ")},m.a.createElement("div",{className:"lblb-default-apps-loader"},m.a.createElement(w.a,null))):t.error_sheet?m.a.createElement("div",{className:a.join(" ")},m.a.createElement("div",{className:"lblb-default-apps-error"},m.a.createElement(y.a,null))):(console.log(t.sentences),m.a.createElement("div",{className:a.join(" ")},m.a.createElement("div",{className:"lblb-default-apps-footer"},m.a.createElement(L.a,null,"Essayez notre g\xe9n\xe9rateur de v\u0153ux pr\xe9sidentiels\xa0!"),m.a.createElement("button",{className:"generateButton",onClick:this.handleGeneration},m.a.createElement(E.a,null,"G\xe9n\xe9rer"),m.a.createElement("img",{src:"/random.png"})),t.selectedSentences.length>0&&m.a.createElement("div",{className:"speech"},m.a.createElement(E.a,{small:!0},t.selectedSentences.slice(0,2).map((function(e){return t.sentences[e]})).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},t.selectedSentences.slice(2,6).map((function(e){return t.sentences[e]})).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},t.selectedSentences.slice(6,10).map((function(e){return t.sentences[e]})).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},t.selectedSentences.slice(10,14).map((function(e){return t.sentences[e]})).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},t.selectedSentences.slice(14,17).map((function(e){return t.sentences[e]})).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},t.selectedSentences.slice(17).map((function(e){return t.sentences[e]})).map(this.renderSentence))),0===t.selectedSentences.length&&m.a.createElement("div",{className:"speech"},m.a.createElement(E.a,{small:!0},this.getParagraph(1,["first"]).map(this.renderSentence),this.getParagraph(1,["intro"]).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},this.getParagraph(4,["crise"]).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},this.getParagraph(4,["r\xe9forme","\xe9conomie"]).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},this.getParagraph(4,["international","\xe9ducation","\xe9cologie"]).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},this.getParagraph(3,["france"]).map(this.renderSentence)),m.a.createElement(E.a,{small:!0},this.getParagraph(1,["last"]).map(this.renderSentence))),m.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},m.a.createElement(L.a,null,"Partagez votre discours\xa0!"),m.a.createElement(_.a,{short:!0,iconsOnly:!0,tweet:n.meta.tweet,url:this.generateShareLink()})),m.a.createElement(v.a,{publishedOn:"02/09/2019 17:13",updatedOn:"03/09/2019 10:36",authors:[{name:"Savinien de Rivet",role:"",link:"www.liberation.fr"},{name:"Maxime Fabas",role:"Production",link:"lol.com"},{name:"Tom F\xe9vrier",role:"Production",link:"lol.com"}]}))))}}]),t}(l.Component),P=n(43),A=n.n(P),G=(n(141),function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(c.a)(this,Object(s.a)(t).call(this,e))).getElementsHeight=n.getElementsHeight.bind(Object(i.a)(n)),window.LBLB_GLOBAL||(window.LBLB_GLOBAL={}),window.LBLB_GLOBAL.rem=16,window.LBLB_GLOBAL.breakpoints={lg:{min:1+63*window.LBLB_GLOBAL.rem,max:1/0},md:{min:1+40*window.LBLB_GLOBAL.rem,max:63*window.LBLB_GLOBAL.rem},sm:{min:0,max:40*window.LBLB_GLOBAL.rem}},Object.defineProperty(window.LBLB_GLOBAL,"current_display",{get:function(){var e=this;return Object.keys(this.breakpoints).find((function(t){return e.breakpoints[t].min<=e.client_width&&e.breakpoints[t].max>=e.client_width}))}}),window.setInterval(n.getElementsHeight,250),n}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentWillUnmount",value:function(){window.clearInterval(this.getElementsHeight)}},{key:"componentDidMount",value:function(){var e=this.props.meta.xiti_id,t=document.createElement("script"),n=document.createElement("script"),a=document.createElement("script"),r=document.createElement("script"),c=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src","https://www.liberation.fr/menu/script.js"),n.innerHTML="\n    var _sf_async_config={};\n    _sf_async_config.uid = 43601;\n    _sf_async_config.domain = 'liberation.fr';\n    _sf_async_config.useCanonical = true;\n    _sf_async_config.sections = \"Static\";\n    _sf_async_config.authors = \"Static\";\n    (function(){\n      function loadChartbeat() {\n        window._sf_endpt=(new Date()).getTime();\n        var e = document.createElement('script');\n        e.setAttribute('language', 'javascript');\n        e.setAttribute('type', 'text/javascript');\n        e.setAttribute('src', 'https://static.chartbeat.com/' + 'js/chartbeat.js');\n        document.body.appendChild(e);\n      }\n      var oldonload = window.onload;\n      window.onload = (typeof window.onload != 'function') ?\n      loadChartbeat : function() { oldonload(); loadChartbeat(); };\n    })();",a.innerHTML="\n    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n     ga('create', 'UA-41822557-1', 'liberation.fr');\n     ga('create', 'UA-116918263-1', 'auto', 'SixPlus');\n     ga('send', 'pageview');\n     ga('SixPlus.send', 'pageview');",r.innerHTML='\n    xtnv = document;\n    xtsd = "https://logliberation";\n    xtsite = "507510";\n    xtn2 = "48";\n    xtpage = "LibeLabo::'.concat(e,'";\n    xtdi = "";\n    xt_pagetype = "";\n    xt_multc = "&x1=0&x2=43&x3=&x4=&x5=&x6=7&x7=";\n    xt_an = "";\n    xt_ac = "";\n    if (window.xtparam==null) { window.xtparam = \'\'; }\n    window.xtparam += "&ptype="+xt_pagetype+"&ac="+xt_ac+"&an="+xt_an+xt_multc;'),c.setAttribute("type","text/javascript"),c.setAttribute("src","https://statics.liberation.fr/bloom/theme/js/xtcore.js"),A.a.show_header&&document.body.appendChild(t),document.body.appendChild(n),document.body.appendChild(a),document.body.appendChild(r),document.body.appendChild(c)}},{key:"getElementsHeight",value:function(){var e=document.querySelector("nav.main-nav"),t=document.querySelector("body"),n=window.LBLB_GLOBAL.nav_height,a=window.LBLB_GLOBAL.body_padding_top,r=window.LBLB_GLOBAL.client_width,c=window.LBLB_GLOBAL.client_height,s=e?e.offsetHeight:0,i=t?parseFloat(window.getComputedStyle(t)["padding-top"].slice(0,-2)):0,o=document.documentElement.clientWidth,l=document.documentElement.clientHeight;window.LBLB_GLOBAL.nav_height=s,window.LBLB_GLOBAL.body_padding_top=i,window.LBLB_GLOBAL.client_width=o,window.LBLB_GLOBAL.client_height=l,n===s&&a===i&&r===o&&c===l||window.dispatchEvent(new CustomEvent("lblb-client-dimensions-change"))}},{key:"render",value:function(){var e=this.props,t=e.meta,n=e.statics_url,a=e.stylesheet,r=t.title,c=t.url,s=t.description,i=t.author,o=t.image;return m.a.createElement("div",{id:"libe-labo-app-wrapper"},m.a.createElement(h.Helmet,null,m.a.createElement("title",null,"Lib\xe9ration.fr \u2013 ",r),m.a.createElement("link",{rel:"canonical",href:c}),m.a.createElement("meta",{name:"author",content:i}),m.a.createElement("meta",{name:"description",content:s}),m.a.createElement("meta",{property:"og:url",content:c}),m.a.createElement("meta",{property:"og:title",content:r}),m.a.createElement("meta",{property:"og:description",content:s}),m.a.createElement("meta",{property:"og:image",content:o}),m.a.createElement("meta",{name:"twitter:url",content:c}),m.a.createElement("meta",{name:"twitter:title",content:r}),m.a.createElement("meta",{name:"twitter:description",content:s}),m.a.createElement("meta",{name:"twitter:image",content:o}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/styles/liberation.css")}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/lib/normalize-8.0.0.css")}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/styles/fonts.css")}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/styles/font-classes.css")}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/styles/components.css")}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/styles/apps.css")}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/lib/leaflet-1.4.0/leaflet.css")}),m.a.createElement("link",{rel:"stylesheet",href:"".concat(n,"/styles/apps/").concat(a)}),m.a.createElement("link",{rel:"stylesheet",href:"./custom.css"})),m.a.createElement(j,e))}}]),t}(l.Component));u.a.render(m.a.createElement(G,A.a),document.getElementById("libe-labo-app-root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},43:function(e,t,n){var a={meta:{author:"",title:"V\u0153ux pr\xe9sidentiels",url:"localhost:3000/",description:"",image:"",xiti_id:"test",tweet:"",konami:"https://github.com/libe-max"},tracking:{active:!1,format:"libe-apps-template",article:"libe-apps-template"},show_header:!0,statics_url:"https://www.liberation.fr/apps/static",api_url:"https://libe-labo-2.site/api",stylesheet:"voeux.css",spreadsheet:"https://docs.google.com/spreadsheets/d/e/2PACX-1vRPOqf8JGmbxsd3C_qIWCSbm-vZ-WWK9yF_Y0kUz_SY5-yDZ2PIcKQl9IPgJPeIW_ZYe5vyzWEVv_tH/pub?gid=155317366&single=true&output=tsv"};e.exports=a},76:function(e,t,n){e.exports=n(142)}},[[76,1,2]]]);
//# sourceMappingURL=main.bd4eb853.chunk.js.map